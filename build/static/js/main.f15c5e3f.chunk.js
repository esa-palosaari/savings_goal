(this.webpackJsonpsummer_aktia=this.webpackJsonpsummer_aktia||[]).push([[0],{48:function(e,a){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAQAAADZc7J/AAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAAmJLR0QA/4ePzL8AAAAHdElNRQfjDB8XDAldjisZAAAA6klEQVRIx+3SPUoDcRDG4ScxiYQkEAwBIxLwAwRBbO3t7EQv4AEEGzvvYa8HsFFQsbDxAMHGykaQIIKuRtEl2b8X2AQWLPfXzsw7H++Qk/MPTE2MVtQVDCelFMZG6nZtm/Pu2ql+1skajsXtsBFWQilxqZt1hT1HS+UDsUWvhWhZyZWQllhMLa/aaZT2TXt24wm2zKd3Sheo6VR1DTVFEpjRyiLw4y1yp6KHGgx8ZLlBrDPafLBg1ZpHn1w4McriwqxzoRzaoR4EPetZXRi49Zs0v5O478yh+3EC4x+JopamLy+TfzEnJwf+AJK9OzPfC5NpAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE5LTEyLTMxVDIzOjEyOjA5KzAxOjAwjMhvhQAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxOS0xMi0zMVQyMzoxMjowOSswMTowMP2V1zkAAABXelRYdFJhdyBwcm9maWxlIHR5cGUgaXB0YwAAeJzj8gwIcVYoKMpPy8xJ5VIAAyMLLmMLEyMTS5MUAxMgRIA0w2QDI7NUIMvY1MjEzMQcxAfLgEigSi4A6hcRdPJCNZUAAAAASUVORK5CYII="},54:function(e,a,t){e.exports=t(95)},59:function(e,a,t){},68:function(e,a,t){},69:function(e,a,t){},70:function(e,a,t){},71:function(e,a,t){},90:function(e,a,t){},91:function(e,a,t){},92:function(e,a,t){},95:function(e,a,t){"use strict";t.r(a);var n=t(0),r=t.n(n),l=t(20),o=t.n(l),s=t(13),c=(t(59),t(4)),i=t.n(c),u=t(6),m=t(15),p=(t(61),t(100)),d=t(101),g=t(28),A=(t(68),function(e,a){console.log("loadAccounts serverId",a);var t="http://localhost:3001/api/accounts/".concat(a);return e.get(t).then((function(e){return console.log(e),e.data}))}),v=function(e){var a=e.account;return r.a.createElement("tr",null,r.a.createElement("td",null,a.iban),r.a.createElement("td",null,a.name),r.a.createElement("td",null,a.balances[0].balanceAmount.amount))},h=t(97);function E(e){var a=Object(n.useState)(!0),t=Object(u.a)(a,2),l=t[0],o=t[1],s=Object(n.useState)([]),c=Object(u.a)(s,2),m=c[0],p=c[1];Object(n.useEffect)((function(){!function(){var a;i.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.isAuthenticated){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,t.next=5,i.a.awrap(d(e.axiosInstance,e.user.id));case 5:a=t.sent,p(a),console.log("accounts in home",a),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(2),alert(t.t0);case 13:o(!1);case 14:case"end":return t.stop()}}),null,null,[[2,10]])}()}),[e.isAuthenticated,e.axiosInstance]);var d=function(e,a){return console.log("serverId in getAccounts",a),A(e,a)},g=function(){var a=Array.from(m).reduce((function(e,a){return e+parseFloat(a.balances[0].balanceAmount.amount)}),0);return r.a.createElement("div",null,r.a.createElement("h5",null,"Tileill\xe4 yhteens\xe4 ",r.a.createElement("span",{className:"tabAll"},a," \u20ac")),e.user.goal?function(){var t=a-e.user.goal;return 0===t?r.a.createElement("h5",null,"Tavoite saavutettu!"):t>0?r.a.createElement("h5",null,"Tavoite ylitetty ",r.a.createElement("span",{className:"tabOver"},t," \u20ac")):r.a.createElement("h5",null,"Tavoitteeseen j\xe4ljell\xe4 ",r.a.createElement("span",{className:"tabUnder"},Math.abs(t)," \u20ac"))}():null)};var E=function(){return r.a.createElement("div",{className:"goal"},r.a.createElement("h5",null,r.a.createElement("b",null,"S\xe4\xe4st\xf6tavoitetta ei ole asetettu.")))},f=function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("hr",null),r.a.createElement("h3",null,"Tilit"),r.a.createElement(h.a,{striped:!0,bordered:!0,hover:!0,responsive:!0,className:"individualAccounts"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"IBAN"),r.a.createElement("th",null,"Nimi"),r.a.createElement("th",null,"Kirjatut varat"))),r.a.createElement("tbody",null,Array.from(m).map((function(e){return r.a.createElement(v,{key:e.iban,account:e})})))))};return r.a.createElement("div",{className:"Home"},e.isAuthenticated?r.a.createElement("div",{className:"accounts"},r.a.createElement("hr",null),r.a.createElement("div",null,l&&r.a.createElement("h5",null,"Ladataan tietoja..."),!l&&(e.user.goal?r.a.createElement("div",{className:"goal"},r.a.createElement("h5",null,"Tavoite ",r.a.createElement("span",{className:"tabGoal"},e.user.goal," \u20ac"))):E()),!l&&g(),l?null:f())):r.a.createElement("div",{className:"lander"},r.a.createElement("h1",null,"S\xe4\xe4st\xf6tavoite"),r.a.createElement("p",null,"Tarkista paljon s\xe4\xe4stett\xe4v\xe4\xe4 sinulla on tavoitteeseesi. ")))}t(69);function f(){return r.a.createElement("div",{className:"NotFound"},r.a.createElement("h3",null,"Sivua ei l\xf6ytynyt!"))}var b=t(99),w=t(102),j=t(21),y=t(98),x=(t(70),t(48)),O=t.n(x);function S(e){var a=e.isLoading,t=e.className,n=void 0===t?"":t,l=e.disabled,o=void 0!==l&&l,s=Object(j.a)(e,["isLoading","className","disabled"]);return r.a.createElement(y.a,Object.assign({className:"LoaderButton ".concat(n),disabled:o||a},s),a&&r.a.createElement("img",{src:O.a,alt:"Logo",className:"spinning"}),s.children)}t(71);var I=t(17),k=t.n(I),L=function(e){var a;return i.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("logging in service"),t.next=3,i.a.awrap(k.a.post("http://localhost:3001/api/login",e));case 3:return a=t.sent,console.log("response from loggin in:",a),t.abrupt("return",a.data);case 6:case"end":return t.stop()}}))},N=t(23),z=t(49);function M(e){var a=Object(n.useState)(e),t=Object(u.a)(a,2),r=t[0],l=t[1];return[r,function(e){l(Object(z.a)({},r,Object(N.a)({},e.target.id,e.target.value)))}]}var C=function(e){console.log("login started");var a=M({email:"",password:""}),t=Object(u.a)(a,2),l=t[0],o=t[1],s=Object(n.useState)(""),c=Object(u.a)(s,2),m=(c[0],c[1]),p=Object(n.useState)(!1),d=Object(u.a)(p,2),g=d[0],A=d[1];return r.a.createElement("div",{className:"Login"},r.a.createElement("form",{onSubmit:function(a){var t,n,r;return i.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return a.preventDefault(),A(!0),t=l.email,n=l.password,console.log("handling login"),o.prev=5,console.log("trying login"),o.next=9,i.a.awrap(L({email:t,password:n}));case 9:(r=o.sent).token="bearer ".concat(r.token),console.log("user token created"),window.localStorage.setItem("loggedAppUser",JSON.stringify(r)),e.setUser(r),console.log(r),e.setUserIsAuthenticated(!0),console.log("pushing history"),A(!1),e.history.push("/"),o.next=26;break;case 21:o.prev=21,o.t0=o.catch(5),m("v\xe4\xe4r\xe4 tunnus tai salasana"),setTimeout((function(){m(null)}),500),A(!1);case 26:case"end":return o.stop()}}),null,null,[[5,21]])}},r.a.createElement(b.a,{controlId:"email",size:"lg"},r.a.createElement(w.a,{autoFocus:!0,type:"email",placeholder:"S\xe4hk\xf6posti",value:l.email,onChange:o})),r.a.createElement(b.a,{controlId:"password",size:"large"},r.a.createElement(w.a,{value:l.password,onChange:o,type:"password",placeholder:"Salasana"})),r.a.createElement(S,{block:!0,size:"lg",isLoading:g,disabled:!(l.email.length>0&&l.password.length>0),type:"submit"},"Kirjaudu sis\xe4\xe4n")))};function P(e){var a=e.component,t=e.appProps,n=Object(j.a)(e,["component","appProps"]);return r.a.createElement(m.d,Object.assign({},n,{render:function(e){return r.a.createElement(a,Object.assign({},e,t))}}))}t(90);var R=function(e){var a;return i.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("logging in service"),t.next=3,i.a.awrap(k.a.post("http://localhost:3001/api/users",e));case 3:return a=t.sent,console.log("response from signing up:",a),t.abrupt("return",a.data);case 6:case"end":return t.stop()}}))};function U(e){console.log("in signup");var a=M({name:"",email:"",password:"",confirmPassword:"",confirmationCode:""}),t=Object(u.a)(a,2),l=t[0],o=t[1],s=Object(n.useState)(null),c=Object(u.a)(s,2),m=(c[0],c[1]),p=Object(n.useState)(!1),d=Object(u.a)(p,2),g=d[0],A=d[1];function v(a){var t;return i.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return a.preventDefault(),A(!0),n.prev=2,n.next=5,i.a.awrap(R({name:l.name,email:l.email,password:l.password}));case 5:t=n.sent,console.log("newUser received?",t),m(t),A(!1),e.history.push("/login"),n.next=16;break;case 12:n.prev=12,n.t0=n.catch(2),alert(n.t0.message),A(!1);case 16:case"end":return n.stop()}}),null,null,[[2,12]])}return r.a.createElement("div",{className:"Signup"},(console.log("rendering signup"),r.a.createElement("form",{onSubmit:v},r.a.createElement(b.a,{controlId:"name",size:"lg"},r.a.createElement(w.a,{autoFocus:!0,placeholder:"Nimi",type:"name",value:l.name,onChange:o})),r.a.createElement(b.a,{controlId:"email",size:"lg"},r.a.createElement(w.a,{placeholder:"S\xe4hk\xf6posti",type:"email",value:l.email,onChange:o})),r.a.createElement(b.a,{controlId:"password",size:"lg"},r.a.createElement(w.a,{placeholder:"Salasana",type:"password",value:l.password,onChange:o})),r.a.createElement(b.a,{controlId:"confirmPassword",size:"lg"},r.a.createElement(w.a,{placeholder:"Vahvista salasana",type:"password",onChange:o,value:l.confirmPassword})),r.a.createElement(S,{block:!0,type:"submit",size:"lg",isLoading:g,disabled:!(l.email.length>0&&l.email.length>0&&l.password.length>0&&l.password===l.confirmPassword)},"Rekister\xf6idy"))))}t(91);var T=function(e,a,t){var n,r;return i.a.async((function(l){for(;;)switch(l.prev=l.next){case 0:return n="http://localhost:3001/api/users/".concat(a),console.log("goal in setGoal",e),l.next=4,i.a.awrap(t.put(n,e));case 4:return r=l.sent,console.log("response from setting goal:",r),l.abrupt("return",r.data);case 7:case"end":return l.stop()}}))},B=function(e){var a=Object(n.useState)(!1),t=Object(u.a)(a,2),l=t[0],o=t[1],s=Object(n.useState)(""),c=Object(u.a)(s,2),m=c[0],p=c[1];return e.isAuthenticated&&r.a.createElement("div",{className:"SetGoal"},r.a.createElement("form",{onSubmit:function(a){var t;return i.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return a.preventDefault(),console.log("goal user:",e.user),console.log("goal field",m),o(!0),n.prev=4,n.next=7,i.a.awrap(T({goal:m},e.user.id,e.axiosInstance));case 7:(t=n.sent)?(e.setUser(t),o(!1),e.history.push("/")):(e.setUserIsAuthenticated(!1),o(!1),e.history.push("/")),n.next=15;break;case 11:n.prev=11,n.t0=n.catch(4),alert(n.t0.message),o(!1);case 15:case"end":return n.stop()}}),null,null,[[4,11]])}},r.a.createElement(b.a,{controlId:"name",size:"mg"},r.a.createElement(w.a,{autoFocus:!0,placeholder:"Uusi tavoite",type:"number",value:m,onChange:function(e){return p(e.target.value)}})),r.a.createElement(S,{block:!0,type:"submit",size:"mg",isLoading:l},"Aseta tavoite")))};function Q(e){var a=e.appProps;return r.a.createElement(m.g,null,r.a.createElement(P,{exact:!0,path:"/",component:E,appProps:a}),r.a.createElement(P,{path:"/goal",component:B,appProps:a}),r.a.createElement(P,{path:"/signup",exact:!0,component:U,appProps:a}),r.a.createElement(P,{path:"/login",exact:!0,component:C,appProps:a}),r.a.createElement(m.d,{component:f}))}t(92);var F=function(e){var a,t;return i.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return a="http://localhost:3001/api/users/".concat(e.serverId),console.log("getting user"),console.log("serverId",e.serverId),n.next=5,i.a.awrap(e.axiosInstance.get(a));case 5:return t=n.sent,console.log("response from getUser server:",t.data),n.abrupt("return",t.data);case 8:case"end":return n.stop()}}))},Z=k.a.create();var J=Object(m.o)((function(e){var a=Object(n.useState)(!0),t=Object(u.a)(a,2),l=t[0],o=t[1],c=Object(n.useState)(!1),m=Object(u.a)(c,2),A=m[0],v=m[1],h=Object(n.useState)(null),E=Object(u.a)(h,2),f=E[0],b=E[1];return Object(n.useEffect)((function(){!function(){var e,a,t,n,r;i.a.async((function(l){for(;;)switch(l.prev=l.next){case 0:if(console.log("onLoad"),!(e=window.localStorage.getItem("loggedAppUser"))){l.next=21;break}return a=JSON.parse(e),b(a),t=a.token,console.log("user in onLoad",a),l.prev=7,Z.defaults.headers.common.Authorization=t,n=JSON.parse(e).id,console.log("serverId in onLoad",n),l.next=13,i.a.awrap(F({axiosInstance:Z,serverId:n}));case 13:r=l.sent,console.log("auth response:",r),r?(b(r),v(!0)):(Z.defaults.headers.common.Authorization=null,window.localStorage.removeItem("loggedAppUser"),v(!1),console.log("auth fail")),l.next=21;break;case 18:l.prev=18,l.t0=l.catch(7),alert(l.t0);case 21:o(!1);case 22:case"end":return l.stop()}}),null,null,[[7,18]])}()}),[]),!l&&r.a.createElement("div",{className:"App container"},r.a.createElement(p.a,{fluid:"true",collapseOnSelect:!0,bg:"light",expand:"lg"},r.a.createElement(p.a.Brand,{as:s.Link,to:"/"},"S\xe4\xe4st\xf6tavoite"),r.a.createElement(p.a.Toggle,{"aria-controls":"responsive-navbar-nav"}),r.a.createElement(p.a.Collapse,null,r.a.createElement(d.a,{className:"ml-auto"},A?r.a.createElement(r.a.Fragment,null,r.a.createElement(g.LinkContainer,{to:"/goal"},r.a.createElement(d.a.Link,null,"Aseta tavoite")),r.a.createElement(d.a.Link,{onClick:function(){window.localStorage.removeItem("loggedAppUser"),Z.defaults.headers.common.Authorization=null,v(!1),e.history.push("/login")}},"Kirjaudu ulos")):r.a.createElement(r.a.Fragment,null,r.a.createElement(g.LinkContainer,{to:"/signup"},r.a.createElement(d.a.Link,null,"Rekister\xf6ityminen")),r.a.createElement(g.LinkContainer,{to:"/login"},r.a.createElement(d.a.Link,null,"Sis\xe4\xe4nkirjautuminen")))))),r.a.createElement(Q,{appProps:{isAuthenticated:A,setUserIsAuthenticated:v,user:f,setUser:b,axiosInstance:Z}}))}));o.a.render(r.a.createElement(s.BrowserRouter,null,r.a.createElement(J,null)),document.getElementById("root"))}},[[54,1,2]]]);
//# sourceMappingURL=main.f15c5e3f.chunk.js.map